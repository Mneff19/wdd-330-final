(()=>{"use strict";const e=new TextEncoder,t=new TextDecoder;const r=t=>(t=>{let r=t;"string"==typeof r&&(r=e.encode(r));const n=[];for(let e=0;e<r.length;e+=32768)n.push(String.fromCharCode.apply(null,r.subarray(e,e+32768)));return btoa(n.join(""))})(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");class n extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class a extends n{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}class s extends n{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}}class o extends n{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}Symbol.asyncIterator;const i=crypto,c=e=>e instanceof CryptoKey;i.getRandomValues.bind(i);const d=(e,t,r=0)=>{0===r&&(t.unshift(t.length),t.unshift(6));let n=e.indexOf(t[0],r);if(-1===n)return!1;const a=e.subarray(n,n+t.length);return a.length===t.length&&(a.every(((e,r)=>e===t[r]))||d(e,t,n+1))},h=e=>{switch(!0){case d(e,[42,134,72,206,61,3,1,7]):return"P-256";case d(e,[43,129,4,0,34]):return"P-384";case d(e,[43,129,4,0,35]):return"P-521";case d(e,[43,101,110]):return"X25519";case d(e,[43,101,111]):return"X448";case d(e,[43,101,112]):return"Ed25519";case d(e,[43,101,113]):return"Ed448";default:throw new a("Invalid or unsupported EC Key Curve or OKP Key Sub Type")}};async function p(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PRIVATE KEY-----"))throw new TypeError('"pkcs8" must be PKCS#8 formatted string');return((e,t,r)=>(async(e,t,r,n,s)=>{let o,c;const d=new Uint8Array(atob(r.replace(e,"")).split("").map((e=>e.charCodeAt(0)))),p="spki"===t;switch(n){case"PS256":case"PS384":case"PS512":o={name:"RSA-PSS",hash:`SHA-${n.slice(-3)}`},c=p?["verify"]:["sign"];break;case"RS256":case"RS384":case"RS512":o={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${n.slice(-3)}`},c=p?["verify"]:["sign"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":o={name:"RSA-OAEP",hash:`SHA-${parseInt(n.slice(-3),10)||1}`},c=p?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":o={name:"ECDSA",namedCurve:"P-256"},c=p?["verify"]:["sign"];break;case"ES384":o={name:"ECDSA",namedCurve:"P-384"},c=p?["verify"]:["sign"];break;case"ES512":o={name:"ECDSA",namedCurve:"P-521"},c=p?["verify"]:["sign"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{const e=h(d);o=e.startsWith("P-")?{name:"ECDH",namedCurve:e}:{name:e},c=p?[]:["deriveBits"];break}case"EdDSA":o={name:h(d)},c=p?["verify"]:["sign"];break;default:throw new a('Invalid or unsupported "alg" (Algorithm) value')}return i.subtle.importKey(t,d,o,s?.extractable??!1,c)})(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",e,t,r))(e,t,r)}Symbol();const u=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,l=e=>{const t=u.exec(e);if(!t)throw new TypeError("Invalid time period format");const r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*r);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*r);case"day":case"days":case"d":return Math.round(86400*r);case"week":case"weeks":case"w":return Math.round(604800*r);default:return Math.round(31557600*r)}};function y(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function f(e,t){return e.name===t}function m(e){return parseInt(e.name.slice(4),10)}function S(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!f(e.algorithm,"HMAC"))throw y("HMAC");const r=parseInt(t.slice(2),10);if(m(e.algorithm.hash)!==r)throw y(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!f(e.algorithm,"RSASSA-PKCS1-v1_5"))throw y("RSASSA-PKCS1-v1_5");const r=parseInt(t.slice(2),10);if(m(e.algorithm.hash)!==r)throw y(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!f(e.algorithm,"RSA-PSS"))throw y("RSA-PSS");const r=parseInt(t.slice(2),10);if(m(e.algorithm.hash)!==r)throw y(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw y("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!f(e.algorithm,"ECDSA"))throw y("ECDSA");const r=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}(t);if(e.algorithm.namedCurve!==r)throw y(r,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}!function(e,t){if(t.length&&!t.some((t=>e.usages.includes(t)))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){const r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw new TypeError(e)}}(e,r)}function E(e,t,...r){if(r.length>2){const t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}const w=(e,...t)=>E("Key must be ",e,...t);function g(e,t,...r){return E(`Key for the ${e} algorithm must be `,t,...r)}const b=e=>c(e),A=["CryptoKey"];class P{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(n,o){if(!this._protectedHeader&&!this._unprotectedHeader)throw new s("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!((...e)=>{const t=e.filter(Boolean);if(0===t.length||1===t.length)return!0;let r;for(const e of t){const t=Object.keys(e);if(r&&0!==r.size)for(const e of t){if(r.has(e))return!1;r.add(e)}else r=new Set(t)}return!0})(this._protectedHeader,this._unprotectedHeader))throw new s("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const d={...this._protectedHeader,...this._unprotectedHeader};let h=!0;if(function(e,t,r,n,s){if(void 0!==s.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some((e=>"string"!=typeof e||0===e.length)))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;o=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t;for(const t of n.crit){if(!o.has(t))throw new a(`Extension Header Parameter "${t}" is not recognized`);if(void 0===s[t])throw new e(`Extension Header Parameter "${t}" is missing`);if(o.get(t)&&void 0===n[t])throw new e(`Extension Header Parameter "${t}" MUST be integrity protected`)}return new Set(n.crit)}(s,new Map([["b64",!0]]),o?.crit,this._protectedHeader,d).has("b64")&&(h=this._protectedHeader.b64,"boolean"!=typeof h))throw new s('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:p}=d;if("string"!=typeof p||!p)throw new s('JWS "alg" (Algorithm) Header Parameter missing or invalid');((e,t,r)=>{e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?((e,t)=>{if(!(t instanceof Uint8Array)){if(!b(t))throw new TypeError(g(e,t,...A,"Uint8Array"));if("secret"!==t.type)throw new TypeError(`${A.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}})(e,t):((e,t,r)=>{if(!b(t))throw new TypeError(g(e,t,...A));if("secret"===t.type)throw new TypeError(`${A.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw new TypeError(`${A.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw new TypeError(`${A.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw new TypeError(`${A.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw new TypeError(`${A.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)})(e,t,r)})(p,n,"sign");let u,l=this._payload;h&&(l=e.encode(r(l))),u=this._protectedHeader?e.encode(r(JSON.stringify(this._protectedHeader))):e.encode("");const y=function(...e){const t=e.reduce(((e,{length:t})=>e+t),0),r=new Uint8Array(t);let n=0;return e.forEach((e=>{r.set(e,n),n+=e.length})),r}(u,e.encode("."),l),f=await(async(e,t,r)=>{const n=await function(e,t,r){if(c(t))return S(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(w(t,...A));return i.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}throw new TypeError(w(t,...A,"Uint8Array"))}(e,t,"sign");((e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}})(e,n);const s=await i.subtle.sign(function(e,t){const r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"EdDSA":return{name:t.name};default:throw new a(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}(e,n.algorithm),n,r);return new Uint8Array(s)})(p,n,y),m={signature:r(f),payload:""};return h&&(m.payload=t.decode(l)),this._unprotectedHeader&&(m.header=this._unprotectedHeader),this._protectedHeader&&(m.protected=t.decode(u)),m}}class H{constructor(e){this._flattened=new P(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){const r=await this._flattened.sign(e,t);if(void 0===r.payload)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}const I=e=>Math.floor(e.getTime()/1e3);function T(e,t){if(!Number.isFinite(t))throw new TypeError(`Invalid ${e} input`);return t}class R{constructor(e={}){if(!function(e){if("object"!=typeof(t=e)||null===t||"[object Object]"!==Object.prototype.toString.call(e))return!1;var t;if(null===Object.getPrototypeOf(e))return!0;let r=e;for(;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:T("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:T("setNotBefore",I(e))}:this._payload={...this._payload,nbf:I(new Date)+l(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:T("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:T("setExpirationTime",I(e))}:this._payload={...this._payload,exp:I(new Date)+l(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:I(new Date)}:e instanceof Date?this._payload={...this._payload,iat:T("setIssuedAt",I(e))}:this._payload={...this._payload,iat:T("setIssuedAt",e)},this}}class v extends R{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(t,r){const n=new H(e.encode(JSON.stringify(this._payload)));if(n.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new o("JWTs MUST NOT use unencoded payload");return n.sign(t,r)}}let C;"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(C="jose/v5.1.3"),new class{constructor(){this.alg="RS256",this.pkcs8="-----BEGIN PRIVATE KEY-----\n        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\n        -----END PRIVATE KEY-----",this.creatJWT()}async creatJWT(){this.privateKey=await p(pkcs8,alg),this.token=await new v({myClaim:!0}).setProtectedHeader({typ:"JWT",alg:"RS256"}).setExpirationTime("6h").setIssuedAt().sign(privateKey),console.log(token)}}})();